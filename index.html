<!DOCTYPE html>
<html lang="en">
<head>
  <!-- PWA Meta Tags -->
    <title>DSE - PWA Test</title>
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#4A90E2">

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WordWise App</title>
    <link rel="icon" type="image/x-icon" href="data:image/x-icon;base64," />
    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin="" />
    <link
      rel="stylesheet"
      as="style"
      onload="this.rel='stylesheet'"
      href="https://fonts.googleapis.com/css2?display=swap&family=Lexend:wght@400;500;600;700&family=Noto+Sans:wght@400;500;700"
    />
    <script src="https://unpkg.com/@phosphor-icons/web" defer></script>

        <style>
      /* =================================== */
      /* --- DESIGN SYSTEM & RESET --- */
      /* =================================== */
      :root {
        /* Colors */
        --text-primary: #111827;      /* Gray 900 */
        --text-secondary: #4b5563;    /* Gray 600 */
        --text-tertiary: #6b7280;     /* Gray 500 */
        --text-on-accent: #ffffff;
        
        --bg-main: #f9fafb;          /* Gray 50 */
        --bg-subtle: #f3f4f6;         /* Gray 100 */
        --bg-ui: #ffffff;
        
        --accent-primary: #3b82f6;   /* Blue 500 */
        --accent-primary-hover: #2563eb; /* Blue 600 */
        
        --border-color: #e5e7eb;      /* Gray 200 */
        --border-focus: #60a5fa;      /* Blue 400 */

        /* Typography */
        --font-primary: 'Lexend', 'Noto Sans', sans-serif;
        --font-secondary: 'Noto Sans', sans-serif;
        
        /* Spacing */
        --space-xs: 0.25rem; --space-sm: 0.5rem; --space-md: 1rem; --space-lg: 1.5rem; --space-xl: 2rem;
        
        /* Shadows */
        --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
        --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
        --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);

        /* CSS "Images" */
        --css-bg-1: 
          radial-gradient(at 0% 0%, hsla(217,89%,63%,0.3) 0px, transparent 50%),
          radial-gradient(at 98% 99%, hsla(303,89%,63%,0.4) 0px, transparent 50%),
          linear-gradient(135deg, hsl(212, 80%, 48%), hsl(265, 80%, 35%));
        
        --css-bg-2: 
          radial-gradient(at 50% -20%, hsla(180, 89%, 63%, 0.3) 0px, transparent 50%),
          linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        
        --css-bg-3:
          radial-gradient(circle at 100% 100%, #ffffff22, #ffffff00 15%),
          linear-gradient(45deg, #1d2b64, #f8cdda);

        --css-bg-4:
          radial-gradient(at 100% 0%, hsla(29, 89%, 63%, 0.3) 0px, transparent 40%),
          linear-gradient(225deg, rgba(2,0,36,1) 0%, rgba(9,9,121,1) 35%, rgba(0,212,255,1) 100%);
      }
      
      html.dark-theme {
        --text-primary: #f9fafb;
        --text-secondary: #9ca3af;
        --text-tertiary: #6b7280;
        
        --bg-main: #111827;
        --bg-subtle: #1f2937;
        --bg-ui: #374151;
        
        --border-color: #4b5563;
        
        --shadow-md: 0 4px 6px -1px rgba(0,0,0,0.3), 0 2px 4px -2px rgba(0,0,0,0.3);
        --shadow-lg: 0 10px 15px -3px rgba(0,0,0,0.3), 0 4px 6px -4px rgba(0,0,0,0.3);
      }

      /* Reset */
      *, *::before, *::after { box-sizing: border-box; }
      body, html { margin: 0; padding: 0; }
      body { font-family: var(--font-primary); background-color: var(--bg-main); color: var(--text-primary); line-height: 1.6; -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale; }
      body.no-scroll { overflow: hidden; }
      i.ph { font-size: 22px; vertical-align: middle; }

      /* =================================== */
      /* --- APP STRUCTURE & LAYOUT --- */
      /* =================================== */
      .app-wrapper, .screen-modal { display: flex; flex-direction: column; min-height: 100vh; }
      .screen-container { display: flex; flex-direction: column; flex-grow: 1; justify-content: space-between; }
      .main-content { flex-grow: 1; }
      .screen { display: none; }
      .screen.active { display: block; overflow-x: hidden; }
      .content-section { padding: var(--space-lg) var(--space-md); }
      #home-screen .content-section:first-child { padding-top: var(--space-lg); }
      
      /* Modals */
      .screen-modal { position: fixed; inset: 0; background-color: var(--bg-main); z-index: 100; display: none; overflow-y: auto; }
      .screen-modal.active { display: flex; }
      
      /* Headers */
      .header { display: flex; align-items: center; justify-content: space-between; padding: var(--space-sm) var(--space-md) var(--space-sm) var(--space-sm); }
      .header-title { font-size: 1.75rem; font-weight: 700; flex: 1; margin: 0; text-align: left; }
      .header-button { display: flex; align-items: center; justify-content: center; width: 3rem; height: 3rem; background: transparent; border: none; cursor: pointer; color: var(--text-secondary); border-radius: 50%; transition: background-color 0.2s, color 0.2s; }
      .header-button:hover { background-color: var(--bg-subtle); color: var(--text-primary); }
      #decks-header, #settings-header { padding: var(--space-md); }
      #view-deck-header .header-title { text-align: center; font-size: 1.25rem; }
      #create-deck-screen .header-title, #add-words-manually-screen .header-title, #test-type-screen .header-title, #deck-type-screen .header-title { font-size: 1.25rem; text-align: center; }
      #quiz-screen .header-title { text-align: center; font-size: 1.25rem; }

      /* =================================== */
      /* --- SHARED COMPONENTS --- */
      /* =================================== */
      .section-title { font-size: 1.25rem; font-weight: 600; margin: 0 0 var(--space-md) 0; padding: 0 var(--space-xs); }
      .content-card-image { width: 100%; aspect-ratio: 16 / 9; background-position: center; background-size: cover; border-radius: 1rem; position: relative; cursor: pointer; overflow: hidden; box-shadow: var(--shadow-md); transition: transform 0.3s ease, box-shadow 0.3s ease; }
      .content-card-image:hover { transform: translateY(-4px); box-shadow: var(--shadow-lg); }
      .css-bg-1, .css-bg-2, .css-bg-3, .css-bg-4 { color: var(--text-on-accent); }
      .css-bg-1 { background-image: var(--css-bg-1); } .css-bg-2 { background-image: var(--css-bg-2); }
      .css-bg-3 { background-image: var(--css-bg-3); } .css-bg-4 { background-image: var(--css-bg-4); }
      .card-overlay-text { position: absolute; inset: 0; z-index: 2; display: flex; flex-direction: column; justify-content: flex-end; gap: var(--space-xs); padding: var(--space-lg); text-shadow: 0 2px 5px rgba(0,0,0,0.4); }
      .card-overlay-text::before { content: ''; position: absolute; inset: 0; border-radius: inherit; background: linear-gradient(0deg, rgba(0, 0, 0, 0.6) 0%, rgba(0, 0, 0, 0) 60%); z-index: -1; }
      .section-subtitle { font-size: 1.75rem; font-weight: 700; margin: 0; }
      .card-text { font-size: 1rem; font-family: var(--font-secondary); margin: 0; opacity: 0.9; }
      .primary-action-button, .secondary-action-button { display: flex; width: 100%; cursor: pointer; align-items: center; justify-content: center; border-radius: 9999px; height: 3rem; border: none; font-size: 1rem; font-weight: 600; transition: all 0.2s ease; }
      .primary-action-button { background-color: var(--accent-primary); color: var(--text-on-accent); box-shadow: var(--shadow-sm); }
      .primary-action-button:hover { background-color: var(--accent-primary-hover); transform: scale(1.03); box-shadow: var(--shadow-md); }
      .secondary-action-button { background-color: var(--bg-ui); color: var(--text-primary); border: 1px solid var(--border-color); box-shadow: var(--shadow-sm); }
      .secondary-action-button:hover { background-color: var(--bg-subtle); border-color: #d1d5db; }
      .action-button-wrapper { padding: var(--space-md); margin-top: auto; }
      .form-group { padding: 0 var(--space-md) var(--space-md); }
      .form-input-large, .form-textarea { width: 100%; resize: none; border-radius: 0.75rem; border: 1px solid var(--border-color); background-color: var(--bg-ui); padding: var(--space-md); font-size: 1rem; box-sizing: border-box; transition: border-color 0.2s, box-shadow 0.2s; }
      .form-input-large:focus, .form-textarea:focus { outline: none; border-color: var(--border-focus); box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.2); }
      .list-option-title { font-size: 1rem; font-weight: 600; padding: var(--space-md) var(--space-md) var(--space-sm); color: var(--text-secondary); }
      .list-option { display: flex; align-items: center; gap: var(--space-md); padding: var(--space-sm) var(--space-md); cursor: pointer; text-decoration: none; color: inherit; border-radius: 0.75rem; margin: 0 var(--space-md) var(--space-sm); transition: background-color 0.2s; }
      .list-option:hover { background-color: var(--bg-subtle); }
      .list-option-icon-wrapper { display: flex; align-items: center; justify-content: center; border-radius: 0.5rem; background-color: var(--bg-subtle); flex-shrink: 0; width: 2.5rem; height: 2.5rem; color: var(--accent-primary); }
      .list-option-text { font-size: 1rem; flex: 1; font-weight: 500; }
      .list-option .ph-caret-right { color: var(--text-tertiary); margin-left: auto; }
      
      /* =================================== */
      /* --- HOME SCREEN & FLASHCARD --- */
      /* =================================== */
      #wotd-card.expanded { position: fixed; inset: 0; z-index: 200; border-radius: 0; padding: 0; }
      #wotd-card.expanded .content-card-image { aspect-ratio: auto; height: 100%; border-radius: 0; }
      #wotd-card.expanded .card-overlay-text { justify-content: center; align-items: center; text-align: center; }
      .flashcard-wrapper { position: relative; border-radius: 1rem; background-color: var(--bg-ui); transition: all 0.4s cubic-bezier(0.65, 0, 0.35, 1); max-height: 250px; overflow: hidden; }
      .flashcard-section { perspective: 1000px; min-height: 200px; cursor: pointer; aspect-ratio: 16 / 9; }
      .flashcard-inner { position: relative; width: 100%; height: 100%; transition: transform 0.7s cubic-bezier(0.25, 1, 0.5, 1); transform-style: preserve-3d; }
      .flashcard-inner.is-flipped { transform: rotateY(180deg); }
      .flashcard-face { position: absolute; width: 100%; height: 100%; -webkit-backface-visibility: hidden; backface-visibility: hidden; display: flex; align-items: center; justify-content: center; flex-direction: column; box-sizing: border-box; border-radius: 1rem; overflow: hidden; box-shadow: var(--shadow-md); }
      .flashcard-face .card-overlay-text { justify-content: center; text-align: center; }
      .flashcard-back { transform: rotateY(180deg); }
      .flashcard-term { font-size: 2rem; font-weight: 700; }
      .flashcard-definition { font-size: 1.125rem; font-family: var(--font-secondary); padding: var(--space-lg); }
      .flashcard-options-toggle { position: absolute; top: var(--space-md); right: var(--space-md); z-index: 10; width: 2.75rem; height: 2.75rem; border-radius: 50%; border: none; background-color: rgba(255, 255, 255, 0.8); backdrop-filter: blur(5px); -webkit-backdrop-filter: blur(5px); box-shadow: var(--shadow-md); cursor: pointer; display: flex; align-items: center; justify-content: center; color: var(--text-primary); transition: all 0.3s cubic-bezier(0.68, -0.55, 0.27, 1.55); }
      .flashcard-options-toggle i.ph { font-size: 24px; transition: transform 0.3s ease-in-out; }
      .flashcard-options-toggle.active { transform: scale(1.1); background-color: rgba(255, 255, 255, 1); }
      .flashcard-options-toggle.active i.ph { transform: rotate(135deg); }
      .flashcard-options-menu { position: absolute; top: calc(var(--space-md) + 3.25rem); right: var(--space-md); z-index: 9; display: flex; flex-direction: column; gap: var(--space-sm); pointer-events: none; }
      .flashcard-options-menu.active { pointer-events: auto; }
      .flashcard-option-item { display: flex; align-items: center; gap: var(--space-sm); padding: var(--space-sm) var(--space-md); background-color: rgba(255, 255, 255, 0.9); backdrop-filter: blur(5px); -webkit-backdrop-filter: blur(5px); border-radius: 9999px; text-decoration: none; color: var(--text-primary); box-shadow: var(--shadow-md); font-weight: 500; font-size: 0.9rem; transform: translateX(calc(100% + 2rem)); opacity: 0; transition: transform 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94), opacity 0.3s ease; }
      .flashcard-option-item:hover { background-color: white; transform: scale(1.05); }
      .flashcard-options-menu.active .flashcard-option-item { transform: translateX(0); opacity: 1; }
      .flashcard-options-menu.active .flashcard-option-item:nth-child(2) { transition-delay: 0.05s; }
      .flashcard-options-menu.active .flashcard-option-item:nth-child(3) { transition-delay: 0.1s; }
      .decks-scroller { display: flex; overflow-x: auto; scrollbar-width: none; padding-bottom: var(--space-md); }
      .decks-scroller::-webkit-scrollbar { display: none; }
      .decks-container { display: flex; align-items: stretch; padding: 0 var(--space-md); gap: var(--space-md); }
      .deck-card { display: flex; flex-direction: column; gap: var(--space-sm); min-width: 160px; text-decoration: none; color: inherit; }
      .deck-card-image, .deck-card-special-image { width: 100%; aspect-ratio: 1 / 1; border-radius: 1rem; box-shadow: var(--shadow-md); transition: transform 0.3s ease, box-shadow 0.3s ease; }
      .deck-card:hover .deck-card-image, .deck-card:hover .deck-card-special-image { transform: translateY(-4px); box-shadow: var(--shadow-lg); }
      .deck-card-special-image { display: flex; align-items: center; justify-content: center; background-color: var(--bg-ui); color: var(--text-secondary); border: 2px dashed var(--border-color); cursor: pointer; }
      .deck-card:hover .deck-card-special-image { border-color: var(--accent-primary); color: var(--accent-primary); }
      .deck-card-title { font-size: 1rem; font-weight: 500; margin: 0; }
      
      /* --- AI CHAT & KEYBOARD AWARE UI --- */
      #home-flashcard-wrapper.chat-active { max-height: 70vh; overflow-y: auto; background-color: var(--bg-subtle); }
      #home-flashcard-wrapper.chat-active::-webkit-scrollbar { display: none; }
      #home-flashcard-wrapper.chat-active { scrollbar-width: none; }
      #home-flashcard-wrapper.chat-active .flashcard-section { aspect-ratio: auto; min-height: 180px; cursor: default; }
      #home-flashcard-wrapper.chat-active .flashcard-face { position: relative; }
      .chat-container { padding: var(--space-md) var(--space-md) 0; display: none; flex-direction: column; opacity: 0; visibility: hidden; transition: opacity 0.5s 0.2s; }
      #home-flashcard-wrapper.chat-active .chat-container { display: flex; opacity: 1; visibility: visible; flex-grow: 1; }
      .chat-log { flex-grow: 1; display: flex; flex-direction: column; gap: var(--space-md); overflow-y: auto; padding-bottom: var(--space-lg); }
      .chat-message { padding: var(--space-sm) var(--space-md); border-radius: 1rem; max-width: 85%; line-height: 1.5; animation: pop-in 0.4s cubic-bezier(0.25, 1, 0.5, 1); word-wrap: break-word; }
      @keyframes pop-in { from { opacity: 0; transform: scale(0.8) translateY(10px); } to { opacity: 1; transform: scale(1) translateY(0); } }
      .ai-message { background-color: var(--bg-ui); color: var(--text-primary); align-self: flex-start; border-bottom-left-radius: 0.25rem; }
      .user-message { background-color: var(--accent-primary); color: var(--text-on-accent); align-self: flex-end; border-bottom-right-radius: 0.25rem; }
      .typing-indicator { align-self: flex-start; color: var(--text-tertiary); font-style: italic; }
      .chat-input-area { display: flex; gap: var(--space-sm); padding: var(--space-md); border-top: 1px solid var(--border-color); background-color: var(--bg-subtle); flex-shrink: 0; }
      .chat-input { flex-grow: 1; border: 1px solid var(--border-color); background-color: var(--bg-ui); border-radius: 9999px; padding: 0 var(--space-md); font-size: 1rem; height: 3rem; }
      .chat-input:focus { outline: none; border-color: var(--border-focus); box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.2); }
      .send-chat-btn { flex-shrink: 0; width: 3rem; height: 3rem; border-radius: 50%; border: none; background-color: var(--accent-primary); color: var(--text-on-accent); cursor: pointer; display: grid; place-items: center; transition: background-color 0.2s; }
      .send-chat-btn:hover { background-color: var(--accent-primary-hover); }
      body.keyboard-visible #home-flashcard-wrapper { position: fixed; inset: 0; z-index: 200; max-height: 100vh; border-radius: 0; display: flex; flex-direction: column; }
      body.keyboard-visible #home-screen > .content-section:not(:nth-child(2)),
      body.keyboard-visible .nav-container { display: none; }
      
      /* --- OTHER SCREENS (DECKS, VIEW DECK, ETC) --- */
      .search-container { padding: 0 var(--space-md) var(--space-md); } .search-input-wrapper { display: flex; width: 100%; height: 3.25rem; align-items: stretch; border-radius: 0.75rem; background-color: var(--bg-ui); border: 1px solid var(--border-color); box-shadow: var(--shadow-sm); } .search-input-wrapper:focus-within { border-color: var(--border-focus); box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.2); } .search-icon { color: var(--text-tertiary); display: flex; align-items: center; padding-left: var(--space-md); } .search-input { flex: 1; border: none; background: transparent; height: 100%; padding: 0 var(--space-md) 0 var(--space-sm); font-size: 1rem; color: var(--text-primary); } .search-input:focus { outline: none; } #search-results-container { padding: 0 var(--space-md) var(--space-md); } .search-result-group-title { font-size: 0.8rem; font-weight: 600; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 0.05em; padding: var(--space-md) 0 var(--space-sm); border-bottom: 1px solid var(--border-color); margin-bottom: var(--space-sm); } .search-result-item { display: flex; align-items: center; gap: var(--space-md); padding: var(--space-sm); cursor: pointer; text-decoration: none; color: inherit; border-radius: 0.75rem; transition: background-color 0.2s ease; } .search-result-item:hover { background-color: var(--bg-subtle); } .search-result-image { width: 48px; height: 48px; border-radius: 0.75rem; background-size: cover; background-position: center; flex-shrink: 0; box-shadow: var(--shadow-sm); } .search-result-icon { width: 48px; height: 48px; border-radius: 0.75rem; background-color: var(--bg-subtle); color: var(--text-secondary); display: flex; align-items: center; justify-content: center; flex-shrink: 0; } .search-result-text-content { flex-grow: 1; overflow: hidden; } .search-result-title { font-size: 1rem; font-weight: 500; color: var(--text-primary); white-space: nowrap; overflow: hidden; text-overflow: ellipsis;} .search-result-subtitle { font-size: 0.875rem; color: var(--text-secondary); } .search-result-item .ph-caret-right { color: var(--text-tertiary); margin-left: auto; } .no-results-message { padding: var(--space-xl) var(--space-md); text-align: center; color: var(--text-secondary); } .sort-filters-container { display: flex; gap: var(--space-sm); padding: var(--space-md); flex-wrap: wrap; } .filter-pill { display: flex; height: 2.25rem; flex-shrink: 0; align-items: center; justify-content: center; border-radius: 9999px; background-color: var(--bg-ui); border: 1px solid var(--border-color); padding: 0 var(--space-md); font-size: 0.875rem; font-weight: 500; cursor: pointer; transition: all 0.2s ease; } .filter-pill:hover { border-color: var(--accent-primary); color: var(--accent-primary); } .decks-grid-container { display: grid; grid-template-columns: repeat(auto-fit, minmax(158px, 1fr)); gap: 1rem; padding: 1rem; } .grid-deck-card { display: flex; flex-direction: column; gap: 0.75rem; text-decoration: none; color: inherit; } .grid-deck-image-wrapper { position: relative; cursor: pointer; } .grid-deck-image { width: 100%; display: block; aspect-ratio: 1 / 1; border-radius: 1rem; box-shadow: var(--shadow-md); transition: transform 0.3s ease, box-shadow 0.3s ease; } .grid-deck-card:hover .grid-deck-image { transform: translateY(-4px); box-shadow: var(--shadow-lg); } .grid-deck-title-wrapper { display: flex; justify-content: space-between; align-items: flex-start; gap: 0.5rem; } .grid-deck-title { font-size: 1rem; font-weight: 500; flex-grow: 1; margin:0; } .grid-deck-subtitle { color: var(--text-secondary); font-size: 0.875rem; margin:0; } .options-container { position: relative; } .options-button { background: none; border: none; cursor: pointer; padding: 0.5rem; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: var(--text-tertiary); width: 2.5rem; height: 2.5rem; } .options-menu { display: none; position: absolute; right: 0; top: 100%; background-color: var(--bg-ui); border-radius: 0.75rem; box-shadow: var(--shadow-lg); z-index: 10; min-width: 140px; overflow: hidden; padding: var(--space-xs); } .options-menu.visible { display: block; } .option-item { display: block; padding: var(--space-sm) var(--space-md); color: var(--text-primary); text-decoration: none; font-size: 0.9rem; white-space: nowrap; border-radius: 0.5rem; } .option-item:hover { background-color: var(--bg-subtle); color: var(--accent-primary); } 
      #view-deck-screen .content-card-image { cursor: default; }
      #view-deck-screen .content-card-image:hover { transform: none; box-shadow: var(--shadow-md); }
      .view-mode-toggle-container { display: flex; background-color: var(--bg-subtle); border-radius: 9999px; padding: var(--space-xs); margin: var(--space-md) auto; width: fit-content; }
      .view-mode-btn { padding: var(--space-sm) var(--space-md); border: none; background-color: transparent; border-radius: 9999px; font-weight: 600; cursor: pointer; transition: background-color 0.2s, color 0.2s; color: var(--text-secondary); }
      .view-mode-btn.active { background-color: var(--bg-ui); color: var(--text-primary); box-shadow: var(--shadow-sm); }
      #deck-flashcard-view { display: none; }
      #deck-flashcard-view.active { display: block; }
      #deck-flashcard-view .flashcard-face { background-image: var(--css-bg-3); }
      #deck-flashcard-definition-container { display: block; height: 100%; text-align: left; overflow-y: auto; }
      #deck-flashcard-definition-container::-webkit-scrollbar { display: none; }
      #deck-flashcard-definition-container { scrollbar-width: none; }
      #deck-definition-view { display: none; }
      #deck-definition-view.active { display: block; }
      #view-deck-screen .content-card-image:hover { transform: none; box-shadow: var(--shadow-md); } #deck-word-display-area { padding: var(--space-lg) 0; } #deck-word-display-area h2 { margin: 0 0 var(--space-xs); font-size: 2rem; font-weight: 700; } #deck-word-display-area h3 { margin: 0 0 var(--space-lg); font-size: 1.125rem; font-weight: 400; color: var(--text-secondary); font-family: var(--font-secondary); } #deck-word-display-area .meaning-block { margin-bottom: var(--space-lg); } #deck-word-display-area .part-of-speech { font-size: 0.9rem; font-weight: 600; font-style: italic; margin-bottom: var(--space-sm); color: var(--text-secondary); } #deck-word-display-area ul { list-style-type: none; padding-left: 0; margin: 0; font-family: var(--font-secondary); } #deck-word-display-area li { margin-bottom: var(--space-sm); padding-left: var(--space-lg); position: relative; } 
      #deck-word-display-area li::before { content: '•'; position: absolute; left: 0; color: var(--accent-primary); font-size: 1.25rem; line-height: 1.2; } .dual-action-buttons { display: flex; gap: var(--space-md); padding: var(--space-md); } .dual-action-buttons .secondary-action-button, .dual-action-buttons .primary-action-button { flex: 1; } .nav-container { border-top: 1px solid var(--border-color); background-color: rgba(255,255,255,0.8); backdrop-filter: blur(8px); -webkit-backdrop-filter: blur(8px); padding: var(--space-sm) var(--space-md); box-shadow: 0 -2px 10px rgba(0,0,0,0.04); position: sticky; bottom: 0; z-index: 50; }
      .nav-bar { display: flex; gap: var(--space-sm); } .nav-link { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; gap: var(--space-xs); border-radius: 0.75rem; text-decoration: none; color: var(--text-secondary); padding: var(--space-xs) 0; transition: color 0.2s, background-color 0.2s; } .nav-link.active { color: var(--accent-primary); } .nav-link:hover { background-color: var(--bg-subtle); } .nav-icon-wrapper { display: flex; height: 1.75rem; align-items: center; justify-content: center; } .nav-text { font-size: 0.75rem; font-weight: 500; }
      html.dark-theme .nav-container { background-color: rgba(31, 41, 55, 0.8); }

      /* =================================== */
      /* --- QUIZ & REVIEW SCREENS --- */
      /* =================================== */
      /* --- MULTIPLE CHOICE QUIZ --- */
      .mc-quiz-prompt-text {
        color: var(--text-primary);
        padding: 0.25rem var(--space-md) 0.75rem;
      }
      .mc-quiz-definition-text {
        font-size: 1.375rem; /* 22px */
        font-weight: 700;
        padding: var(--space-lg) var(--space-md) 0.75rem;
        line-height: 1.3;
      }
      .mc-quiz-options-container {
        display: flex;
        flex-direction: column;
        gap: 0.75rem;
        padding: var(--space-md);
      }
      .mc-option-label {
        display: flex;
        align-items: center;
        gap: 1rem;
        padding: 1rem; /* p-[15px] is ~1rem */
        border: 1px solid var(--border-color);
        border-radius: 0.75rem; /* rounded-xl */
        cursor: pointer;
        transition: border-color 0.2s, background-color 0.2s;
      }
      .mc-option-label:hover {
        background-color: var(--bg-subtle);
      }
      .mc-option-label.selected {
        border-color: var(--accent-primary);
        background-color: hsla(217, 89%, 63%, 0.1);
      }
      .mc-option-input {
        /* Visually hide the radio button but keep it accessible */
        position: absolute;
        opacity: 0;
        width: 0;
        height: 0;
      }
      .mc-radio-custom {
        width: 1.25rem; /* h-5 w-5 */
        height: 1.25rem;
        border: 2px solid var(--border-color);
        border-radius: 50%;
        flex-shrink: 0;
        display: grid;
        place-content: center;
        transition: border-color 0.2s;
      }
      .mc-option-label.selected .mc-radio-custom {
        border-color: var(--accent-primary);
      }
      .mc-radio-custom::before {
        content: '';
        width: 0.75rem;
        height: 0.75rem;
        border-radius: 50%;
        background-color: var(--accent-primary);
        transform: scale(0);
        transition: transform 0.2s ease-in-out;
      }
      .mc-option-label.selected .mc-radio-custom::before {
        transform: scale(1);
      }
      .mc-option-text {
        font-weight: 500;
      }
      #mc-quiz-submit-btn:disabled {
        background-color: #b2cae5; /* A lighter shade from your design */
        color: #6b7280; /* text-tertiary */
        cursor: not-allowed;
        transform: none;
        box-shadow: none;
      }
      html.dark-theme #mc-quiz-submit-btn:disabled {
        background-color: #374151; /* bg-ui */
        color: #6b7280; /* text-tertiary */
      }
      /* Correct/Incorrect Styling */
      .mc-option-label.correct {
        border-color: #22c55e;
        background-color: rgba(34, 197, 94, 0.1);
      }
      .mc-option-label.incorrect {
        border-color: #ef4444;
        background-color: rgba(239, 68, 68, 0.1);
      }
      .quiz-progress-container { padding: var(--space-md); display: flex; flex-direction: column; gap: var(--space-sm); }
      .quiz-progress-text { font-size: 1rem; font-weight: 500; color: var(--text-secondary); }
      .quiz-progress-bar-background { height: 0.5rem; width: 100%; background-color: var(--bg-subtle); border-radius: 9999px; overflow: hidden; }
      .quiz-progress-bar-foreground { height: 100%; background-color: var(--accent-primary); border-radius: 9999px; transition: width 0.3s ease; }
      #quiz-question-title { font-size: 1.375rem; font-weight: 700; text-align: center; padding: var(--space-lg) var(--space-md) var(--space-sm); }
      #quiz-card { margin: 0 var(--space-md); border-radius: 1rem; }
      #quiz-card .card-overlay-text { gap: var(--space-sm); }
      #quiz-card-word { font-size: 1.5rem; font-weight: 700; }
      #quiz-card-definition { font-size: 1rem; font-weight: 500; }
      #quiz-buttons { display: flex; flex-direction: column; gap: var(--space-sm); padding: var(--space-lg) var(--space-md); }
      .quiz-answer-btn { display: flex; width: 100%; cursor: pointer; align-items: center; justify-content: center; border-radius: 9999px; height: 3rem; border: 2px solid transparent; font-size: 1rem; font-weight: 700; transition: all 0.2s ease; }
      .quiz-answer-btn.true { background-color: #b2cae5; color: var(--text-primary); }
      html.dark-theme .quiz-answer-btn.true { background-color: var(--accent-primary); color: var(--text-on-accent); }
      .quiz-answer-btn.false { background-color: var(--bg-subtle); color: var(--text-primary); }
      .quiz-answer-btn.correct { background-color: #22c55e; color: white; border-color: #16a34a; }
      .quiz-answer-btn.incorrect { background-color: #ef4444; color: white; border-color: #dc2626; }
      .quiz-answer-btn:disabled { cursor: not-allowed; opacity: 0.7; }
      #quiz-result-overlay { position: fixed; inset: 0; z-index: 250; display: none; align-items: center; justify-content: center; background-color: rgba(0, 0, 0, 0.5); }
      #quiz-result-content { background-color: var(--bg-ui); color: var(--text-primary); padding: var(--space-xl); border-radius: 1rem; text-align: center; box-shadow: var(--shadow-lg); display: flex; flex-direction: column; align-items: center; gap: var(--space-md); }
      #quiz-result-content i.ph { font-size: 48px; }
      #quiz-result-content.correct { color: #22c55e; }
      #quiz-result-content.incorrect { color: #ef4444; }
      #quiz-review-screen .header-title { text-align: center; font-size: 1.25rem; }
      .score-summary { padding: var(--space-xl) var(--space-md); text-align: center; display: flex; flex-direction: column; align-items: center; gap: var(--space-md); }
      .score-circle { width: 120px; height: 120px; border-radius: 50%; background-color: var(--bg-subtle); border: 4px solid var(--accent-primary); display: grid; place-items: center; box-shadow: var(--shadow-md); }
      #review-score-text { font-size: 2.5rem; font-weight: 700; color: var(--accent-primary); }
      #review-score-description { font-size: 1.125rem; font-weight: 500; color: var(--text-secondary); }
      .review-list-title { font-size: 1rem; font-weight: 600; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 0.05em; padding: 0 var(--space-md) var(--space-sm); border-bottom: 1px solid var(--border-color); margin: 0 var(--space-md) var(--space-md); }
      #review-list { display: flex; flex-direction: column; gap: var(--space-md); padding: 0 var(--space-md) var(--space-lg); }
      .review-item { background-color: var(--bg-ui); border: 1px solid var(--border-color); border-radius: 1rem; padding: var(--space-md); box-shadow: var(--shadow-md); }
      .review-item-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--space-md); }
      .review-question-number { font-size: 0.875rem; font-weight: 600; color: var(--text-secondary); }
      .review-result-icon { font-size: 28px; }
      .review-result-icon.correct { color: #22c55e; }
      .review-result-icon.incorrect { color: #ef4444; }
      .review-question-content .word { font-weight: 700; margin-bottom: var(--space-xs); }
      .review-question-content .definition { color: var(--text-secondary); }
      .review-explanation-block { margin-top: var(--space-md); padding: var(--space-sm) var(--space-md); background-color: var(--bg-subtle); border-left: 4px solid; border-radius: 0 0.5rem 0.5rem 0; font-size: 0.9rem; }
      .review-explanation-block.correct { border-color: #22c55e; }
      .review-explanation-block.incorrect { border-color: #ef4444; }

      /* =================================== */
      /* --- NEW: CHAT SCREEN STYLES --- */
      /* =================================== */
      /* --- SUGGESTED REPLIES STYLES --- */
      .suggested-replies-container {
        display: flex;
        flex-wrap: wrap;
        gap: var(--space-sm);
        padding: var(--space-sm) var(--space-md) var(--space-md);
        border-top: 1px solid var(--border-color);
        background-color: var(--bg-ui);
      }
      .suggested-reply-btn {
        padding: 0.375rem 0.875rem;
        font-size: 0.875rem;
        font-weight: 500;
        background-color: var(--bg-subtle);
        color: var(--text-secondary);
        border: 1px solid var(--border-color);
        border-radius: 9999px;
        cursor: pointer;
        transition: all 0.2s ease-in-out;
      }
      .suggested-reply-btn:hover {
        background-color: var(--accent-primary);
        border-color: var(--accent-primary-hover);
        color: var(--text-on-accent);
        transform: translateY(-2px);
      }
      .suggested-reply-btn.prompt-suggestion {
        background-color: hsla(217, 89%, 63%, 0.1);
        color: var(--accent-primary);
        border-color: hsla(217, 89%, 63%, 0.3);
        font-weight: 600;
      }
      /* Adjust main chat area to make space for suggestions */
      .chat-main {
        padding-bottom: 0; /* Remove existing bottom padding */
      }
      .chat-log-area {
        padding-bottom: var(--space-sm);
      }
      #chat-screen.active { display: flex; height: 100vh; overflow: hidden; flex-direction: column; }
      #chat-screen .app-container { display: flex; flex-grow: 1; min-height: 0; }
      .chat-screen-wrapper { display: flex; height: 100%; width: 100%; overflow: hidden; position: relative; }
      .chat-header { position: absolute; top: 0; left: 0; right: 0; z-index: 10; display: flex; align-items: center; justify-content: space-between; padding: var(--space-sm); background-color: var(--bg-ui); border-bottom: 1px solid var(--border-color); box-shadow: var(--shadow-sm); }
      .header-left-cluster { display: flex; align-items: center; gap: var(--space-xs); position: relative; }
      .header-right-cluster { position: relative; }
      .chat-header .header-button { display: flex; align-items: center; justify-content: center; gap: var(--space-xs); height: 3rem; padding: 0 var(--space-md); background: transparent; border: none; cursor: pointer; color: var(--text-secondary); border-radius: 0.75rem; transition: background-color 0.2s; }
      .chat-header .header-button.icon-only { width: 3rem; padding: 0; }
      .chat-header .header-button:hover { background-color: var(--bg-subtle); }
      #model-switcher-btn .ph { font-size: 18px; }
      .sidebar-toggle { display: none; }
      .popover-menu { display: none; position: absolute; top: calc(100% + var(--space-sm)); background-color: var(--bg-ui); border-radius: 0.75rem; box-shadow: var(--shadow-lg); z-index: 11; min-width: 140px; overflow: hidden; padding: var(--space-xs); animation: pop-in 0.2s ease-out; }
      @keyframes pop-in { from { opacity: 0; transform: translateY(-10px) scale(0.95); } to { opacity: 1; transform: translateY(0) scale(1); } }
      .popover-menu.active { display: block; }
      #model-popover { left: 0; }
      #options-popover { right: 0; }
      .popover-item { display: flex; align-items: center; gap: var(--space-sm); padding: var(--space-sm) var(--space-md); color: var(--text-primary); text-decoration: none; font-size: 0.9rem; white-space: nowrap; border-radius: 0.5rem; cursor: pointer; }
      .popover-item:hover { background-color: var(--bg-subtle); }
      .popover-item i.ph-fill { color: var(--accent-primary); }
      .chat-sidebar { width: 280px; flex-shrink: 0; background-color: var(--bg-subtle); border-right: 1px solid var(--border-color); display: flex; flex-direction: column; transition: transform 0.3s ease-in-out; }
      .sidebar-header { padding: var(--space-md); }
      .new-chat-btn { display: flex; align-items: center; justify-content: center; gap: var(--space-sm); width: 100%; height: 3rem; border-radius: 0.75rem; border: none; background-color: var(--accent-primary); color: var(--text-on-accent); font-size: 1rem; font-weight: 600; cursor: pointer; transition: background-color 0.2s; }
      .new-chat-btn:hover { background-color: var(--accent-primary-hover); }
      .history-list { list-style: none; padding: 0 var(--space-sm); margin: 0; overflow-y: auto; flex-grow: 1; }
      .history-item { display: block; text-decoration: none; color: inherit; padding: var(--space-sm) var(--space-md); border-radius: 0.75rem; margin-bottom: var(--space-xs); cursor: pointer; }
      .history-item:hover { background-color: var(--bg-ui); }
      .history-item.active { background-color: var(--accent-primary); color: var(--text-on-accent); box-shadow: var(--shadow-md); }
      .history-item-title { font-weight: 500; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
      .history-item-preview { font-size: 0.875rem; opacity: 0.7; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
      .history-item.active .history-item-preview { opacity: 0.9; }
      .chat-main { flex-grow: 1; display: flex; flex-direction: column; padding-top: 60px; background-color: var(--bg-ui); }
      .chat-log-area { flex-grow: 1; overflow-y: auto; padding: var(--space-lg) var(--space-md); display: flex; flex-direction: column; gap: var(--space-lg); }
      .chat-message-wrapper { display: flex; flex-direction: column; gap: var(--space-sm); }
      #chat-screen .chat-message { display: flex; gap: var(--space-sm); max-width: 100%; } /* Overriding max-width for full-width bubbles */
      .avatar { width: 36px; height: 36px; flex-shrink: 0; border-radius: 50%; display: grid; place-items: center; font-weight: 600; }
      .message-content { padding: var(--space-sm) var(--space-md); border-radius: 1rem; line-height: 1.5; }
      
      #chat-screen .ai-message { align-self: flex-start; }
      #chat-screen .ai-message .avatar { background-color: var(--bg-subtle); color: var(--accent-primary); }
      #chat-screen .ai-message .message-content { background-color: var(--bg-subtle); color: var(--text-primary); border-bottom-left-radius: 0.25rem; }
      
      #chat-screen .user-message { align-self: flex-end; }
      #chat-screen .user-message .chat-message { flex-direction: row-reverse; }
      #chat-screen .user-message .avatar { background-color: var(--accent-primary); color: var(--text-on-accent); }
      #chat-screen .user-message .message-content { background-color: var(--accent-primary); color: var(--text-on-accent); border-bottom-right-radius: 0.25rem; }

      #chat-screen .typing-indicator { color: var(--text-tertiary); font-style: italic; animation: blink 1.5s infinite; }
      @keyframes blink { 50% { opacity: 0.5; } }
      .bubble-actions { display: flex; align-items: center; gap: var(--space-md); padding-left: calc(36px + var(--space-sm)); }
      .action-btn { background: none; border: none; color: var(--text-tertiary); cursor: pointer; display: flex; align-items: center; gap: var(--space-xs); font-size: 0.8rem; padding: var(--space-xs); border-radius: 0.5rem; transition: background-color 0.2s, color 0.2s; }
      .action-btn:hover { background-color: var(--bg-subtle); color: var(--text-primary); }
      .action-btn i.ph { font-size: 16px; }
      .chat-input-container { padding: var(--space-md); border-top: 1px solid var(--border-color); background-color: var(--bg-ui); display: flex; align-items: flex-end; gap: var(--space-sm); }
      .chat-textarea { flex-grow: 1; border: 1px solid var(--border-color); border-radius: 1.5rem; padding: 0.75rem var(--space-md); font-size: 1rem; font-family: inherit; resize: none; max-height: 150px; overflow-y: auto; }
      .chat-textarea:focus { outline: none; border-color: var(--border-focus); box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.2); }
      #chat-screen .send-chat-btn { flex-shrink: 0; width: 3rem; height: 3rem; border-radius: 50%; border: none; background-color: var(--accent-primary); color: var(--text-on-accent); cursor: pointer; display: grid; place-items: center; transition: background-color 0.2s; }
      #chat-screen .send-chat-btn:hover { background-color: var(--accent-primary-hover); }
      .sidebar-overlay { position: fixed; inset: 0; background-color: rgba(0,0,0,0.5); z-index: 19; opacity: 0; pointer-events: none; transition: opacity 0.3s ease-in-out; }
      @media (max-width: 768px) {
        .sidebar-toggle { display: flex; }
        .chat-sidebar { position: fixed; top: 0; left: 0; bottom: 0; z-index: 20; transform: translateX(-100%); }
        .chat-header { left: 0; }
        #chat-screen .app-container.sidebar-open .chat-sidebar { transform: translateX(0); box-shadow: var(--shadow-lg); }
        #chat-screen .app-container.sidebar-open .sidebar-overlay { opacity: 1; pointer-events: auto; }
      }
      @media (min-width: 769px) {
        .chat-header { left: 280px; }
      }
            .deck-card-image, .grid-deck-image-wrapper {
        position: relative; /* This is crucial for positioning the tag inside */
      }
      .deck-card-tag {
        position: absolute;
        top: var(--space-sm);
        left: var(--space-sm);
        font-size: 0.75rem;
        font-weight: 600;
        padding: 0.2rem 0.6rem;
        border-radius: 0.5rem;
        background-color: rgba(0, 0, 0, 0.25);
        color: rgba(255, 255, 255, 0.9);
        backdrop-filter: blur(4px);
        -webkit-backdrop-filter: blur(4px);
        border: 1px solid rgba(255, 255, 255, 0.2);
        z-index: 5;
      }
      .deck-card {
        gap: 0.75rem; /* Slightly increase gap to accommodate title */
      }
      .deck-card-title {
        padding-top: 0; /* Remove extra space above title */
      }
      .grid-deck-subtitle {
        color: var(--text-secondary); 
        font-size: 0.875rem; 
        margin:0;
      }
      /* --- AI Marker Styles --- */

/* Styles for the small icon in chat bubbles */
.ai-message .message-content {
    position: relative;
}

.ai-marker {
    position: absolute;
    bottom: 5px;
    right: 8px;
    line-height: 1;
}

.ai-marker i.ph-sparkle {
    font-size: 1rem;
    color: var(--text-tertiary);
    opacity: 0.7;
    transition: opacity 0.2s;
}

.ai-marker i.ph-sparkle:hover {
    opacity: 1;
}


/* Styles for the "AI Explanation" text in quiz reviews */
.ai-marker-inline {
    display: flex;
    align-items: center;
    gap: 0.4em;
    font-size: 0.8rem;
    font-weight: 500;
    color: var(--text-secondary);
    margin-bottom: 0.75rem;
}

.ai-marker-inline i.ph-sparkle {
    font-size: 0.9rem;
}

      /* =================================== */
      /* --- NEW: MOVIE SCREEN STYLES --- */
      /* =================================== */
      .movie-grid-container {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(158px, 1fr));
          gap: 1rem;
          padding: 1rem;
      }
      .movie-card {
          text-decoration: none;
          color: inherit;
      }
      .movie-card-poster-wrapper {
          position: relative;
          cursor: pointer;
      }
      .movie-card-poster {
          width: 100%;
          display: block;
          aspect-ratio: 2 / 3;
          border-radius: 1rem;
          background-color: var(--bg-subtle);
          background-size: cover;
          background-position: center;
          box-shadow: var(--shadow-md);
          transition: transform 0.3s ease, box-shadow 0.3s ease;
      }
      .movie-card:hover .movie-card-poster {
          transform: translateY(-4px) scale(1.02);
          box-shadow: var(--shadow-lg);
      }
      .movie-card-title-wrapper {
          display: flex;
          justify-content: space-between;
          align-items: flex-start;
          gap: 0.5rem;
          margin-top: 0.75rem;
      }
      .movie-card-title {
          font-size: 1rem;
          font-weight: 500;
          flex-grow: 1;
          margin:0;
      }
      .add-movie-card {
          display: flex;
          flex-direction: column;
          align-items: center;
          justify-content: center;
          aspect-ratio: 2 / 3;
          border-radius: 1rem;
          border: 2px dashed var(--border-color);
          color: var(--text-tertiary);
          cursor: pointer;
          transition: all 0.2s;
      }
      .add-movie-card:hover {
          border-color: var(--accent-primary);
          color: var(--accent-primary);
          background-color: var(--bg-subtle);
      }
      .add-movie-card p {
          font-weight: 500;
          margin-top: var(--space-sm);
      }
      #movie-detail-poster {
          width: 100%;
          aspect-ratio: 16 / 9;
          border-radius: 1rem;
          background-color: var(--bg-subtle);
          background-size: cover;
          background-position: center top; /* Focus on the top part for wide aspect ratio */
          box-shadow: var(--shadow-lg);
          margin-bottom: var(--space-lg);
      }
      #movie-detail-description {
          font-family: var(--font-secondary);
          color: var(--text-secondary);
      }
      
      /* New Modal Header Styles */
      .modal-header {
        padding: var(--space-md);
      }
      .modal-header .header-title { 
        font-size: 1.25rem;
        text-align: center;
      }

      /* Subtitle Player Styles */
      #movie-player-screen .modal-header {
          border-bottom: 1px solid var(--border-color);
      }
      .subtitle-player-container {
          flex-grow: 1;
          overflow-y: auto;
          padding: var(--space-md);
      }
      .subtitle-line {
          display: flex;
          align-items: flex-start;
          gap: var(--space-md);
          padding: var(--space-sm) 0;
          border-bottom: 1px solid var(--bg-subtle);
      }
      .subtitle-line-number {
          font-size: 0.875rem;
          font-weight: 500;
          color: var(--text-tertiary);
          min-width: 2rem;
          text-align: right;
          padding-top: 0.1rem;
      }
      .subtitle-line-text {
          flex-grow: 1;
          font-family: var(--font-secondary);
      }
      .subtitle-add-btn {
          background: none;
          border: none;
          color: var(--text-tertiary);
          cursor: pointer;
          padding: 0 var(--space-sm);
          border-radius: 50%;
          opacity: 0.5;
          transition: all 0.2s;
      }
      .subtitle-line:hover .subtitle-add-btn {
          opacity: 1;
          color: var(--accent-primary);
      }
      .subtitle-add-btn:hover {
          background-color: var(--bg-subtle);
      }

      /* Add Movie Modal */
      .api-search-result {
          display: none; /* Hidden by default */
          text-align: center;
          padding: var(--space-md);
          margin: 0 var(--space-md) var(--space-md);
          border-radius: 1rem;
          border: 1px solid var(--border-color);
      }
      .api-search-result img {
          max-width: 120px;
          border-radius: 0.75rem;
          box-shadow: var(--shadow-md);
          margin-bottom: var(--space-md);
      }
      .manual-entry-form {
          display: none; /* Hidden by default */
      }
      /* --- Deck Progress Bar --- */
      .deck-progress-wrapper {
          display: flex;
          align-items: center;
          gap: var(--space-sm);
          margin-top: var(--space-sm);
      }
      .deck-progress-bar-container {
          flex-grow: 1; /* Make the bar take up available space */
          height: 6px;
          background-color: var(--bg-subtle);
          border-radius: 9999px;
          overflow: hidden;
      }
      .deck-progress-bar {
          height: 100%;
          background-color: var(--accent-primary);
          border-radius: 9999px;
          transition: width 0.5s ease-out;
      }
      .deck-progress-percentage {
          font-size: 0.75rem;
          font-weight: 600;
          color: var(--text-secondary);
          flex-shrink: 0; /* Prevent the text from shrinking */
      }
      .filter-pill.active {
          background-color: var(--accent-primary);
          color: var(--text-on-accent);
          border-color: var(--accent-primary-hover);
      }
      .filter-pill.active:hover {
          background-color: var(--accent-primary-hover);
          color: var(--text-on-accent);
      }
    </style>
</head>
<body>
    <!-- Main App Screens -->
    <div id="main-app-container" class="app-wrapper">
      <div class="main-content">
        <!-- ===== HOME SCREEN ===== -->
        <div id="home-screen" class="screen active">
            <!-- (Home screen content remains the same) -->
            <div class="content-section">
                <h3 class="section-title">Word of the Day</h3>
                <div id="wotd-card">
                    <div class="content-card-image css-bg-1">
                        <div class="card-overlay-text">
                            <p class="section-subtitle">Serendipity</p>
                            <p class="card-text">The occurrence and development of events by chance in a happy or beneficial way.</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="content-section">
                <h3 class="section-title">Flashcard</h3>
                <div class="flashcard-wrapper" id="home-flashcard-wrapper">
                    <button class="flashcard-options-toggle" aria-label="Toggle card options"><i class="ph ph-plus"></i></button>
                    <div class="flashcard-options-menu">
                        <a href="#" class="flashcard-option-item"><i class="ph-fill ph-play-circle"></i><span>Practice</span></a>
                        <a href="#" class="flashcard-option-item" id="ask-ai-btn"><i class="ph-fill ph-sparkle"></i><span>Ask AI</span></a>
                        <a href="#" class="flashcard-option-item" id="gemini-btn"><i class="ph-fill ph-brain"></i><span>Gemini</span></a>
                    </div>
                    <div class="flashcard-section" id="flashcard">
                        <div class="flashcard-inner">
                            <div class="flashcard-face flashcard-front css-bg-4"><div class="card-overlay-text"><p class="flashcard-term" id="home-flashcard-term">Ephemeral</p></div></div>
                            <div class="flashcard-face flashcard-back css-bg-4"><div class="card-overlay-text"><p class="flashcard-definition" id="home-flashcard-definition">Lasting for a very short time.</p></div></div>
                        </div>
                    </div>
                                        <div class="chat-container" style="display: none;">
                        <div class="chat-log" id="chat-log"></div>
                        <div class="chat-input-area">
                            <input type="text" id="chat-input" placeholder="Ask a follow-up..." class="chat-input">
                            <button class="send-chat-btn" id="send-chat-btn" aria-label="Send message"><i class="ph-fill ph-paper-plane-tilt"></i></button>
                        </div>
                    </div>
                </div>
                <div class="dual-action-buttons" style="padding: var(--space-md) 0 0;">
                    <button id="home-i-dont-know-btn" class="secondary-action-button">I don't know</button>
                    <button id="home-i-know-btn" class="primary-action-button">I know</button>
                </div>
            </div>
            <div class="content-section">
                <h3 class="section-title">Decks</h3>
                <div class="decks-scroller">
                    <div class="decks-container" id="home-decks-container">
                        <div class="deck-card" id="view-all-decks-btn"><div class="deck-card-special-image"><i class="ph ph-arrow-right"></i></div><p class="deck-card-title">View All</p></div>
                    </div>
                </div>
            </div>
        </div>
        <!-- ===== DECKS SCREEN ===== -->
        <div id="decks-screen" class="screen">
            <!-- (Decks screen content remains the same) -->
             <div class="header" id="decks-header">
              <h2 class="header-title">Decks</h2>
              <button class="header-button" id="add-deck-btn" aria-label="Add new deck"><i class="ph ph-plus"></i></button>
          </div>
          <div class="search-container"><div class="search-input-wrapper"><div class="search-icon"><i class="ph ph-magnifying-glass"></i></div><input placeholder="Search decks and words" class="search-input" id="main-search-input" type="search" /></div></div>
          <div id="search-results-container" style="display: none;"></div>
          <div id="default-decks-view">
            <div class="sort-filters-container" id="deck-filter-pills-container">
            <div class="filter-pill active" data-filter="all">All</div>
            <div class="filter-pill" data-filter="recent">Recent</div>
            <div class="filter-pill" data-filter="alpha">A-Z</div>
            <div class="filter-pill" data-filter="newest">Newest</div>
            <div class="filter-pill" data-filter="Vocabulary">Vocabulary</div>
            <div class="filter-pill" data-filter="Expressions">Expressions</div>
            <div class="filter-pill" data-filter="Subtitle">Subtitles</div>
          </div>
            <div class="decks-grid-container" id="decks-grid-container"></div>
          </div>
        </div>
        <!-- ===== VIEW DECK SCREEN ===== -->
        <div id="view-deck-screen" class="screen">
            <!-- (View Deck screen content remains the same) -->
            <div class="screen-container">
                <div>
                    <div class="header" id="view-deck-header">
                        <button class="header-button" id="back-to-decks-btn" aria-label="Back to decks"><i class="ph ph-arrow-left"></i></button>
                        <h2 class="header-title">Deck Title</h2>
                        <div style="width: 3rem;"></div>
                    </div>
                         <div class="content-section" style="padding-top: 0;">
                        <div class="view-mode-toggle-container">
                            <button id="deck-flashcard-mode-btn" class="view-mode-btn active">Flashcard</button>
                            <button id="deck-definition-mode-btn" class="view-mode-btn">Definition</button>
                        </div>
                        <div id="view-deck-content-area">
                            <div id="deck-flashcard-view" class="flashcard-section active">
                                <div class="flashcard-inner">
                                    <div class="flashcard-face flashcard-front">
                                        <div class="card-overlay-text">
                                            <p id="deck-flashcard-term" class="flashcard-term">Word</p>
                                        </div>
                                    </div>
                                    <div class="flashcard-face flashcard-back">
                                        <div id="deck-flashcard-definition-container" class="card-overlay-text"></div>
                                    </div>
                                </div>
                            </div>
                            <div id="deck-definition-view">
                                <div id="deck-word-display-area"></div>
                                <div id="gemini-amharic-definition-area" style="margin-top: var(--space-xl); padding: 0 var(--space-lg);"></div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="dual-action-buttons">
                    <button id="deck-i-dont-know-btn" class="secondary-action-button">I don't know</button>
                    <button id="deck-i-know-btn" class="primary-action-button">I know</button>
                </div>
            </div>
        </div>
        
        <!-- ===== NEW: CHAT SCREEN ===== -->
        <div id="chat-screen" class="screen">
            <div class="app-container" id="full-chat-app-container">
                <div class="chat-screen-wrapper">
                    <!-- Sidebar -->
                    <aside class="chat-sidebar" id="chat-sidebar">
                        <div class="sidebar-header">
                            <button class="new-chat-btn" id="new-chat-btn"><i class="ph-fill ph-plus-circle"></i> New Chat</button>
                        </div>
                        <ul class="history-list" id="chat-history-list">
                            <!-- Conversation history will be rendered here by JS -->
                        </ul>
                    </aside>

                    <!-- Main Chat Interface -->
                    <main class="chat-main">
                        <header class="chat-header">
                            <div class="header-left-cluster">
                                <button id="exit-chat-btn" class="header-button icon-only" aria-label="Back to main app"><i class="ph ph-arrow-left"></i></button>
                                <button class="header-button icon-only sidebar-toggle" id="chat-sidebar-toggle"><i class="ph ph-list"></i></button>
                                                                <button class="header-button" id="model-switcher-btn"><i class="ph-fill ph-sparkle"></i> <span id="current-model-name">WordWise Agent</span> <i class="ph ph-caret-down"></i></button>
                                <div class="popover-menu" id="model-popover">
                                    <a class="popover-item" data-model="GeminiAgent"><i class="ph-fill ph-sparkle"></i> Gemini Agent</a>
                                    <a class="popover-item" data-model="Groq"><i class="ph ph-fast-forward"></i> Groq (Fast)</a>
                                </div>
                            </div>
                            <div class="header-right-cluster">
                                <button class="header-button icon-only" id="options-btn"><i class="ph ph-dots-three-vertical"></i></button>
                                <div class="popover-menu" id="options-popover">
                                    <a class="popover-item" id="delete-chat-btn"><i class="ph ph-trash"></i> Delete Chat</a>
                                </div>
                            </div>
                        </header>
                        
                        <div class="chat-log-area" id="main-chat-log-area">
                            <!-- Chat messages will be rendered here by JS -->
                        </div>
<!-- NEW: Container for Suggested Replies -->
                        <div class="suggested-replies-container" id="main-suggested-replies-container">
                            <!-- Suggested replies will be rendered here by JS -->
                        </div>

                        <div class="chat-input-container">
                            <textarea class="chat-textarea" id="main-chat-textarea" placeholder="Ask about a word..." rows="1"></textarea>
                            <button class="send-chat-btn" id="main-send-chat-btn" aria-label="Send message"><i class="ph-fill ph-paper-plane-tilt"></i></button>
                        </div>
                    </main>
                </div>
                <div class="sidebar-overlay" id="chat-sidebar-overlay"></div>
            </div>
        </div>
                
        <!-- ===== MOVIE SCREEN ===== -->
        <div id="movie-list-screen" class="screen">
            <div class="header">
                <h2 class="header-title">Movies</h2>
                <button class="header-button" id="add-movie-btn" aria-label="Add new movie"><i class="ph ph-plus"></i></button>
            </div>
            <div class="search-container">
                <div class="search-input-wrapper">
                    <div class="search-icon"><i class="ph ph-magnifying-glass"></i></div>
                    <input placeholder="Search movies" class="search-input" id="movie-list-search-input" type="search" />
                </div>
            </div>
            <div id="movie-search-results-container" style="display: none;"></div>
            <div id="default-movies-view">
                 <div class="movie-grid-container" id="movie-grid">
                    <!-- Movie cards will be rendered here by JS -->
                </div>
            </div>
        </div>
        <!-- ===== SETTINGS SCREEN ===== -->
        <div id="settings-screen" class="screen">
            <!-- (Settings screen content remains the same) -->
             <div class="header" id="settings-header"><h2 class="header-title">Settings</h2></div>
             <div class="content-section">
                 <h3 class="list-option-title">Appearance</h3>
                 <div id="theme-toggle-btn" class="list-option">
                     <div class="list-option-icon-wrapper"><i id="theme-icon" class="ph ph-moon"></i></div>
                     <p class="list-option-text">Toggle Dark Mode</p>
                 </div>
                 <h3 class="list-option-title">API Keys</h3>
                 <div class="list-option" style="display: block; cursor: default; margin-bottom: var(--space-md);">
                     <p class="list-option-text" style="font-weight: normal; margin-bottom: var(--space-sm);">GroqCloud API Key</p>
                     <div style="display: flex; gap: var(--space-sm);">
                         <input type="password" id="groq-api-key-input" class="form-input-large" style="padding: 0.75rem 1rem; height: auto;">
                         <button id="save-groq-api-key-btn" class="primary-action-button" style="width: auto; padding: 0 1.5rem; border-radius: 0.75rem;">Save</button>
                     </div>
                 </div>
                 <div class="list-option" style="display: block; cursor: default;">
                     <p class="list-option-text" style="font-weight: normal; margin-bottom: var(--space-sm);">Gemini API Key</p>
                     <div style="display: flex; gap: var(--space-sm);">
                         <input type="password" id="gemini-api-key-input" class="form-input-large" style="padding: 0.75rem 1rem; height: auto;">
                         <button id="save-gemini-api-key-btn" class="primary-action-button" style="width: auto; padding: 0 1.5rem; border-radius: 0.75rem;">Save</button>
                     </div>
                 </div>
                 <div class="list-option" style="display: block; cursor: default; margin-top: var(--space-md);">
                     <p class="list-option-text" style="font-weight: normal; margin-bottom: var(--space-sm);">Unsplash Access Key</p>
                     <div style="display: flex; gap: var(--space-sm);">
                         <input type="password" id="unsplash-api-key-input" class="form-input-large" style="padding: 0.75rem 1rem; height: auto;">
                         <button id="save-unsplash-api-key-btn" class="primary-action-button" style="width: auto; padding: 0 1.5rem; border-radius: 0.75rem;">Save</button>
                     </div>
                 </div>
                 <div class="list-option" style="display: block; cursor: default; margin-top: var(--space-md);">
                     <p class="list-option-text" style="font-weight: normal; margin-bottom: var(--space-sm);">OMDb API Key</p>
                     <div style="display: flex; gap: var(--space-sm);">
                         <input type="password" id="omdb-api-key-input" class="form-input-large" style="padding: 0.75rem 1rem; height: auto;">
                         <button id="save-omdb-api-key-btn" class="primary-action-button" style="width: auto; padding: 0 1.5rem; border-radius: 0.75rem;">Save</button>
                     </div>
                 </div>
                 <h3 class="list-option-title">About</h3>
                 <div class="list-option"><div class="list-option-icon-wrapper"><i class="ph ph-info"></i></div><p class="list-option-text">Version 1.0.0</p></div>
             </div>
        </div>
      </div>
      <!-- ===== SHARED BOTTOM NAVIGATION ===== -->
      <div class="nav-container"><div class="nav-bar"><a class="nav-link active" id="nav-home" href="#"><div class="nav-icon-wrapper"><i class="ph-fill ph-house"></i></div><p class="nav-text">Home</p></a><a class="nav-link" id="nav-decks" href="#"><div class="nav-icon-wrapper"><i class="ph ph-cards"></i></div><p class="nav-text">Decks</p></a><a class="nav-link" id="nav-chat" href="#"><div class="nav-icon-wrapper"><i class="ph ph-chat-circle-dots"></i></div><p class="nav-text">Chat</p></a><a class="nav-link" id="nav-movie" href="#"><div class="nav-icon-wrapper"><i class="ph ph-film-strip"></i></div><p class="nav-text">Movie</p></a><a class="nav-link" id="nav-settings" href="#"><div class="nav-icon-wrapper"><i class="ph ph-gear"></i></div><p class="nav-text">Settings</p></a></div></div>
    </div>

    <!-- ===== MODAL SCREENS ===== -->

    <!-- NEW "CHOOSE DECK TYPE" MODAL -->
    <div id="deck-type-screen" class="screen-modal">
        <div class="screen-container">
            <div>
                <div class="header">
                    <div style="width: 3rem;"></div> <!-- Spacer -->
                    <h2 class="header-title">Choose Deck Type</h2>
                    <button class="header-button" data-action="close-modal"><i class="ph ph-x"></i></button>
                </div>
                <h3 class="list-option-title">Select a Category</h3>
                <a href="#" class="list-option" id="create-deck-vocabulary">
                    <div class="list-option-icon-wrapper"><i class="ph ph-text-t"></i></div>
                    <p class="list-option-text">Vocabulary</p>
                </a>
                <a href="#" class="list-option" id="create-deck-expressions">
                    <div class="list-option-icon-wrapper"><i class="ph ph-chat-teardrop-text"></i></div>
                    <p class="list-option-text">Expressions</p>
                </a>
                <a href="#" class="list-option" id="create-deck-subtitle">
                    <div class="list-option-icon-wrapper"><i class="ph ph-closed-captioning"></i></div>
                    <p class="list-option-text">Subtitle</p>
                </a>
            </div>
        </div>
    </div>
    
    <!-- EXISTING MODALS -->
    <div id="create-deck-screen" class="screen-modal">
        <div class="screen-container">
            <div>
                <div class="header">
                    <button class="header-button" id="close-create-deck-btn"><i class="ph ph-x"></i></button>
                    <h2 class="header-title" id="create-deck-modal-title">Create Deck</h2>
                    <button class="header-button" id="delete-deck-btn" style="display: none; color: #ef4444;"><i class="ph ph-trash"></i></button>
                </div>
                <div class="form-group">
                    <input placeholder="Deck Title" id="deck-title-input" class="form-input-large" />
                </div>
                <div class="form-group">
                    <textarea placeholder="Description (optional)" id="deck-description-input" class="form-textarea"></textarea>
                </div>
                <h3 class="section-title" style="padding: 0 var(--space-md) var(--space-sm);">Add Words</h3>
                <div class="list-option" id="add-manually-btn"><div class="list-option-icon-wrapper"><i class="ph ph-plus"></i></div><p class="list-option-text">Add Manually</p></div>
                <div class="list-option" id="import-from-list-btn"><div class="list-option-icon-wrapper"><i class="ph ph-upload-simple"></i></div><p class="list-option-text">Import from List</p></div>
            </div>
            <div class="action-button-wrapper">
                <button class="primary-action-button" id="create-deck-submit-btn">Create Deck</button>
            </div>
        </div>
    </div>
    <div id="add-words-manually-screen" class="screen-modal">
        <div class="screen-container">
            <div>
                <div class="header">
                     <button class="header-button" id="back-to-create-deck-btn"><i class="ph ph-arrow-left"></i></button>
                    <h2 class="header-title">Add Words Manually</h2>
                    <div style="width: 3rem;"></div>
                </div>
                <div class="form-group">
                    <textarea id="manual-words-textarea" placeholder="Enter one word per line..." class="form-textarea" style="height: calc(100vh - 200px)"></textarea>
                </div>
            </div>
            <div class="action-button-wrapper">
                <button id="save-manual-words-btn" class="primary-action-button">Save Words</button>
            </div>
        </div>
    </div>
    <div id="test-type-screen" class="screen-modal">
        <div class="screen-container">
            <div>
                <div class="header">
                     <div style="width: 3rem;"></div> <!-- Spacer -->
                    <h2 class="header-title">Choose a Test</h2>
                    <button class="header-button close-modal-btn" data-destination="decks"><i class="ph ph-x"></i></button>
                </div>
                <h3 class="list-option-title">Test Modes</h3>
                <a href="#" id="start-tf-quiz-btn" class="list-option"><div class="list-option-icon-wrapper"><i class="ph ph-check-fat"></i></div><p class="list-option-text">True or False</p></a>
                <a href="#" id="start-mc-quiz-btn" class="list-option"><div class="list-option-icon-wrapper"><i class="ph ph-list-checks"></i></div><p class="list-option-text">Multiple Choice</p></a>
                <a href="#" class="list-option"><div class="list-option-icon-wrapper"><i class="ph ph-text-t"></i></div><p class="list-option-text">Fill in the Blank</p></a>
            </div>
        </div>
    </div>

    <!-- ===== QUIZ & REVIEW SCREENS ===== -->
    <!-- NEW "MULTIPLE CHOICE" QUIZ SCREEN -->
    <div id="mc-quiz-screen" class="screen-modal">
        <div class="screen-container">
            <div>
                <div class="header">
                    <button id="close-mc-quiz-btn" class="header-button" aria-label="Close Quiz"><i class="ph ph-x"></i></button>
                    <h2 class="header-title">Vocabulary Quiz</h2>
                     <div style="width: 3rem;"></div> <!-- Spacer -->
                </div>
                <div class="quiz-progress-container">
                    <p id="mc-quiz-progress-text" class="quiz-progress-text">1/10</p>
                    <div class="quiz-progress-bar-background">
                        <div id="mc-quiz-progress-bar" class="quiz-progress-bar-foreground" style="width: 10%;"></div>
                    </div>
                </div>
                <p id="mc-quiz-prompt" class="mc-quiz-prompt-text">Choose the word that best fits the definition:</p>
                <h1 id="mc-quiz-definition" class="mc-quiz-definition-text">A feeling of great happiness and triumph.</h1>
                <div id="mc-quiz-options-container" class="mc-quiz-options-container">
                    <!-- Options will be dynamically inserted here by JS -->
                </div>
            </div>
            <div class="action-button-wrapper">
                <button id="mc-quiz-submit-btn" class="primary-action-button" disabled>Submit</button>
            </div>
        </div>
    </div>
    <div id="quiz-screen" class="screen-modal">
        <div class="screen-container">
            <div>
              <div class="header">
                <button id="close-quiz-btn" class="header-button" aria-label="Close Quiz"><i class="ph ph-x"></i></button>
                <h2 class="header-title">Vocabulary Challenge</h2>
                <div style="width: 3rem;"></div>
              </div>
              <div class="quiz-progress-container">
                <p id="quiz-progress-text" class="quiz-progress-text">1/10</p>
                <div class="quiz-progress-bar-background">
                  <div id="quiz-progress-bar" class="quiz-progress-bar-foreground" style="width: 10%;"></div>
                </div>
              </div>
              <h1 id="quiz-question-title">Is this definition correct?</h1>
              <div id="quiz-card" class="content-card-image css-bg-2">
                <div class="card-overlay-text">
                    <p id="quiz-card-word" class="section-subtitle">Ephemeral</p>
                    <p id="quiz-card-definition" class="card-text">Lasting for a very short time</p>
                </div>
              </div>
            </div>
            <div id="quiz-buttons">
              <button id="true-btn" class="quiz-answer-btn true">Correct</button>
              <button id="false-btn" class="quiz-answer-btn false">Incorrect</button>
            </div>
        </div>
    </div>
    <div id="quiz-result-overlay">
      <div id="quiz-result-content">
        <i id="quiz-result-icon" class="ph-fill ph-check-circle"></i>
        <h2 id="quiz-result-text" style="font-size: 1.5rem; font-weight: 700;">Correct!</h2>
      </div>
    </div>
    <div id="quiz-review-screen" class="screen-modal">
        <div class="screen-container">
            <div>
              <div class="header">
                 <div style="width: 3rem;"></div> <!-- Spacer -->
                <h2 class="header-title">Quiz Review</h2>
                 <div style="width: 3rem;"></div> <!-- Spacer -->
              </div>
              <div class="score-summary">
                <div class="score-circle">
                  <span id="review-score-text">0/10</span>
                </div>
                <p id="review-score-description">Let's see how you did!</p>
              </div>
              <h3 class="review-list-title">Your Answers</h3>
              <div id="review-list" class="review-list"></div>
            </div>
            <div class="action-button-wrapper">
              <button id="quiz-done-btn" class="primary-action-button">Done</button>
            </div>
        </div>
    </div>
    <!-- ===== MOVIE MODAL SCREENS ===== -->
    <!-- Add Movie Modal -->
    <div id="add-movie-modal" class="screen-modal">
        <div class="screen-container">
            <div>
                <div class="header modal-header">
                    <div style="width: 3rem;"></div>
                    <h2 class="header-title">Add a New Movie</h2>
                    <button class="header-button close-modal-btn"><i class="ph ph-x"></i></button>
                </div>
                <div class="form-group">
                    <p style="text-align:center; color: var(--text-secondary); margin-bottom: var(--space-md);">Search OMDb for a movie to auto-fill details.</p>
                    <div style="display: flex; gap: var(--space-sm);">
                        <input placeholder="Enter movie title..." id="movie-search-input" class="form-input-large" />
                        <button id="movie-search-btn" class="primary-action-button" style="width: auto; padding: 0 1.5rem; border-radius: 0.75rem;">Search</button>
                    </div>
                    <p id="movie-search-status" style="text-align:center; color: var(--text-tertiary); min-height: 1.6rem;"></p>
                </div>

                <!-- This section is shown after a successful API search -->
                <div id="api-search-result" class="api-search-result">
                    <img id="api-result-poster" src="" alt="Movie Poster">
                    <h3 id="api-result-title" style="margin: 0 0 var(--space-xs);"></h3>
                    <p id="api-result-year" style="margin: 0; color: var(--text-secondary);"></p>
                </div>

                <!-- This section is shown if API search fails -->
                <div id="manual-entry-form" class="manual-entry-form">
                    <h3 class="section-title" style="text-align:center; color: var(--text-secondary); font-weight: 500;">Or, enter details manually:</h3>
                    <div class="form-group">
                        <input placeholder="Movie Title" id="manual-movie-title" class="form-input-large" />
                    </div>
                    <div class="form-group">
                        <textarea placeholder="Description" id="manual-movie-description" class="form-textarea"></textarea>
                    </div>
                    <div class="form-group">
                        <input placeholder="Poster Image URL" id="manual-movie-poster" class="form-input-large" />
                    </div>
                </div>
            </div>
            <div class="action-button-wrapper">
                <button class="primary-action-button" id="add-movie-submit-btn">Add Movie</button>
            </div>
        </div>
    </div>

    <!-- Movie Detail Modal -->
    <div id="movie-detail-screen" class="screen-modal">
        <div class="screen-container">
            <div>
                <div class="header modal-header">
                    <button class="header-button close-modal-btn"><i class="ph ph-arrow-left"></i></button>
                    <h2 class="header-title" id="movie-detail-title">Movie Title</h2>
                    <div style="width: 3rem;"></div>
                </div>
                <div class="content-section">
                    <div id="movie-detail-poster"></div>
                    <p id="movie-detail-description">Movie description goes here.</p>
                </div>
            </div>
            <div class="action-button-wrapper">
                <button class="primary-action-button" id="play-subtitles-btn"><i class="ph-fill ph-play" style="margin-right: var(--space-sm);"></i> Play Subtitles</button>
            </div>
        </div>
    </div>

    <!-- Subtitle Player Modal -->
    <div id="movie-player-screen" class="screen-modal">
        <div class="screen-container" style="max-height: 100vh;">
            <div class="header modal-header">
                <button class="header-button close-modal-btn"><i class="ph ph-arrow-left"></i></button>
                <h2 class="header-title" id="movie-player-title">Subtitles</h2>
                <div style="width: 3rem;"></div>
            </div>
            <div class="subtitle-player-container" id="subtitle-player-container">
                <!-- Subtitle lines will be rendered here by JS -->
            </div>
        </div>
    </div>

    <!-- Hidden file inputs for Movie feature -->
    <input type="file" id="srt-upload-input" style="display: none;" accept=".srt" />

    <input type="file" id="import-file-input" style="display: none;" accept=".txt" />
 <script>
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
          navigator.serviceWorker.register('/sw.js').then(registration => {
            console.log('ServiceWorker registration successful with scope: ', registration.scope);
          }, err => {
            console.log('ServiceWorker registration failed: ', err);
          });
        });
      }
    </script>
    <!-- Add this to enable the Gemini SDK -->
    <script type="module">
        import { GoogleGenerativeAI } from "https://esm.run/@google/generative-ai";
        // Make the SDK globally available so app.js can use it
        window.GoogleGenerativeAI = GoogleGenerativeAI;
    </script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js" defer></script>
     <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js" defer></script>
    <script src="app.js" defer></script>
    
</body>
</html>